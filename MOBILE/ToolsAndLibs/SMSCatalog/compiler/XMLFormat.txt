Формат XML файла для генерации SMS каталога

(С)2005-2006 Raydac Research Group Ltd.

Версия 1.6
Автор: И.А.Мазница (igor.maznitsa@raydac-research.com)

DTD описатель XML файла
--------------------------

<?xml version="1.0" encoding="UTF-8"?>
<!ELEMENT Catalog (savestringsasbytes?,agreement?,fuzzyiteminfo?,send2friend?,game?, scr+)>
<!ATTLIST Catalog
	client CDATA #REQUIRED
	agreement CDATA #IMPILED
	advertisement CDATA #IMPLIED
	url CDATA #IMPLIED
	validity CDATA #IMPLIED
	smsnum CDATA #REQUIRED
	cost CDATA #REQUIRED
>
<!ELEMENT game EMPTY>
<!ATTLIST game
	name CDATA #REQUIRED
>
<!ELEMENT advertisement EMPTY>
<!ELEMENT send2friend EMPTY>
<!ATTLIST send2friend
	smsnum CDATA #IMPLIED
>
<!ELEMENT compatible EMPTY>
<!ATTLIST compatible
	vendor CDATA #REQUIRED
	models CDATA #REQUIRED
>
<!ELEMENT item (compatible*)>
<!ATTLIST item
	preview CDATA #IMPLIED
	name CDATA #REQUIRED
	cost CDATA #REQUIRED
	resid CDATA #REQUIRED
	smsnum CDATA #IMPLIED
	ref CDATA #IMPLIED
    type (GAME | IMAGE | SOUND | SMSSERVICE | INFO) #IMPLIED
>
<!ELEMENT link EMPTY>
<!ATTLIST link
	name CDATA #REQUIRED
	scr CDATA #REQUIRED
>
<!ELEMENT fuzzyiteminfo EMPTY>
<!ELEMENT savestringsasbytes EMPTY>
<!ELEMENT scr (link+ | item+)>
<!ATTLIST scr
	id CDATA #REQUIRED
	name CDATA #IMPLIED
    type (GAME | IMAGE | SOUND | SMSSERVICE | INFO) #IMPLIED
>


Пример

<?xml version="1.0" encoding="UTF-8"?>
<Catalog client="CLIENT_NAME" validity="10.11.2007" url="http://wap.choice.com.ua/SMScatalog.jad" smsnum="10601" cost="16.00 у.е. без НДС">
 <agreement text="Вам уже 18 лет?"/>
 <advertisement ref="Пейте кока колу!" validity="25.03.2005"/>
 <savestringsasbytes />
    <scr id="SMS Каталог">
        <link name="Словари" scr="Dicts"/>
        <link name="Игры" scr="Games"/>
    </scr>
    <scr id="Dicts" name="Словари">
        <item preview="file://slovar.png" name="Dictionary.ENG-RUS" cost="16.00 у.е. без НДС" resid="586525" smsnum="10601">
	        <compatible vendor="NOKIA" models="3410,6100,7650"/>
        </item>
        <item preview="file://slovar.png" name="Dictionary.ENG-RUS" cost="16.00 у.е. без НДС" resid="586525" smsnum="10601">
	        <compatible vendor="NOKIA" models="3410,6100,7650"/>
	        <compatible vendor="SIEMENS" models="m55,s55,cx65"/>
        </item>
    </scr>
    <scr id="Games" name="Игры">
        <item name="Air Boil" cost="6.00 у.е. без НДС" resid="486490" smsnum="10640" ref="Аркада с 20 уровнями и четырьмя боссами">
        </item>
        <item name="Star Harbor" cost="6.00 у.е. без НДС" resid="486491" smsnum="10640">
        </item>
    </scr>
</Catalog>

Тег scr должен обязательно иметь или атрибут id или атрибут name, в случае отстутствия одного из этих атрибутов, его значение берется из существующего.

Атрибут тега item, prev - может быть в следующих форматах:
"file://resourcefilename" - в каталог записывается файл, содержащий ресурс. Пример "file://preview.png" (картинка из того же каталога где и XML файл)

Тег <Catalog>

Является главным тегом и имеет атрибуты:
agreement - (необязателен) содержит текст соглашения перед переходом в содержимое каталога
client - (обязателен) содержит информацию о принадлежности каталога
url - (необязателен) содержит URL каталога в сети
validity - (необязателен) содержит дату действия каталога, после данной даты, будет выводиться предупреждение об устарении каталога.
cost - (обязателен) содержит стоимость контента используемую по умолчанию, т.е. если у тега item не указан свой тег cost  (может быть опущен если <fuzzyiteminfo>)
smsnum - (обязателен) содержит сервисный смс номер для контента по умолчанию, т.е. если у тега item не указан свой тег smsnum то используется значение из корневого (может быть опущен если <fuzzyiteminfo>)

Тег <advertisement>

Дает команду до определенной даты (включительно) отображать рекламную информацию в виде всплывающего окна в течение 3 секунд. При наличии изображение с именем adv.png, оно будет использовано как иконка окна, иначе будет отображена информационная иконка.
ref - (обязателен) содержит текст рекламы.
validity - (необязателен) содержит дату до которой сообщение валидно.

Тег <agreement>

Дает команду каталогу перед запуском отобразить экран с соглашением с командами Да и Нет, если пользователь выбирает Нет то каталог закрывается.
атрибуты
text - (обязателен) содержит текст соглашения.

Тег <savestringsasbytes>

Показывает системе компиляции, что текст каталога должен быть сохранен в байтовом формате, если отсутствует то текст сохраняется в UTF.

Тег <fuzzyiteminfo>

Предписывает отключение проверки наличия некоторых обязательных атрибутов в корневом элементе и элементах каталога.

Тег <game>

Подключает к каталогу заданную игру.
    Атрибуты:
        name - (обязателен) указывает имя класса игры.

Тег <send2friend>

Включает для контента возможность отправки заказа на чужой номер телефона, так называемая "Отправка другу".
Атрибуты:
    smsnum - (необязателен) номер отправки сформиованной SMS с заказом, если не задан то отправка идет на номер указанный для контента

Тег <scr>

Тег описывает один экран и имеет следующие атрибуты:
 id - (обязателен) уникальный идентификатор экрана
 name - (необязателен) отображаемое имя экрана
 type - (необязателен) тип контента представленного на экране IMAGE|SOUND|GAME

Тег <item>

 Описывает единицу контента и имеет следующие атрибуты:
 name - (обязателен) отображаемое имя контента
 cost - (необязателен) стоимость контента
 resid - (обязателен) уникальный идентификатор контента (может быть опущен если <fuzzyiteminfo>)
 smsnum - (необязателен) номер сервиса смс для данного контента (может быть опущен если <fuzzyiteminfo>)
 preview - (необязателен) ссылка на ресурс содержащий превью для данного контента
 ref - (необязателен) содержит текстовое описание объекта
 Так же данный тег item может включать до 255 тегов compatible показывающих какими устройствами поддерживается контент и имеющих атрибуты
    vendor - (обязателен) проивзодитель
    models - (обязателен) список моделей через запятую

Тег <link>

Описывает ссылку на связанный экран и имеет атрибуты:
name - (обязателен) отображаемое имя ссылки
scr - (обязателен) id целевого экрана

Макросы

%res% - идентификатор посылаемого текста для заказа ресурса, может содержаться в атрибуте ref
%num% - идентификатор номера, куда должен быть отправлен заказ, может содержаться в атрибуте ref
%channel% - идентификатор канала дистрибуции, загружается из манифеста Jar и содержится в  переменной dchannel, может содержаться в поле resid
%number% - идентификатор канала дистрибуции, загружается из манифеста Jar и содержится в  переменной dnumber, может содержаться в поле smsnum   